---
import "../styles/global.css";

interface Props {
	title?: string;
	description?: string;
	image?: string;
	canonical?: string;
}

const {
	title = "Parth Sinha - Full Stack Developer | Portfolio 2025",
	description = "Full Stack Developer passionate about creating elegant solutions. Experienced in JavaScript, TypeScript, React, Node.js, Python, AWS, Docker, and modern web technologies. Explore my projects and blog posts on software development.",
	image = "/images/Holi%20Joy_%20A%20Vibrant%20Portrait%20of%20Celebration.png",
	canonical = Astro.url.pathname,
} = Astro.props;

// Dynamic base URL
const baseUrl = Astro.site || new URL(Astro.url.origin);
const canonicalURL = new URL(canonical, baseUrl);
const imageUrl = new URL(image, baseUrl);

// Structured data for SEO
const structuredData = {
	"@context": "https://schema.org",
	"@type": "Person",
	"name": "Parth Sinha",
	"url": baseUrl.href,
	"image": imageUrl.href,
	"sameAs": [
		"https://github.com/sinhaparth5",
		"https://www.linkedin.com/in/parth-sinha18",
		"https://x.com/sinhaparth555",
		"https://parth-sinha.medium.com"
	],
	"jobTitle": "Full Stack Developer",
	"worksFor": {
		"@type": "Organization",
		"name": "Freelance"
	},
	"description": description,
	"email": "sinhaparth555@gmail.com",
	"knowsAbout": [
		"JavaScript",
		"TypeScript",
		"React",
		"Node.js",
		"Python",
		"AWS",
		"Docker",
		"MongoDB",
		"Next.js",
		"Tailwind CSS",
		"GraphQL",
		"PostgreSQL"
	]
};
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="generator" content={Astro.generator} />

		<!-- Primary Meta Tags -->
		<title>{title}</title>
		<meta name="title" content={title} />
		<meta name="description" content={description} />
		<meta name="author" content="Parth Sinha" />
		<meta name="keywords" content="Parth Sinha, Full Stack Developer, Web Developer, JavaScript, TypeScript, React, Node.js, Python, AWS, Docker, MongoDB, Portfolio, Software Engineer, Frontend Developer, Backend Developer" />
		<meta name="robots" content="index, follow" />
		<meta name="language" content="English" />
		<meta name="revisit-after" content="7 days" />

		<!-- Canonical URL -->
		<link rel="canonical" href={canonicalURL} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={imageUrl} />
		<meta property="og:image:alt" content="Parth Sinha - Full Stack Developer Portfolio" />
		<meta property="og:site_name" content="Parth Sinha Portfolio" />
		<meta property="og:locale" content="en_US" />

		<!-- Twitter -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:url" content={canonicalURL} />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={imageUrl} />
		<meta name="twitter:image:alt" content="Parth Sinha - Full Stack Developer Portfolio" />
		<meta name="twitter:creator" content="@sinhaparth555" />
		<meta name="twitter:site" content="@sinhaparth555" />

		<!-- Additional Meta Tags -->
		<meta name="theme-color" content="#1A1A1A" />
		<meta name="msapplication-TileColor" content="#1A1A1A" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<!-- Structured Data (JSON-LD) -->
		<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />

		<!-- DNS Prefetch & Preconnect for Performance -->
		<link rel="dns-prefetch" href="https://fonts.googleapis.com" />
		<link rel="dns-prefetch" href="https://fonts.gstatic.com" />
		<link rel="dns-prefetch" href="https://api.github.com" />
		<link rel="dns-prefetch" href="https://medium.com" />

		<!-- Fonts with Optimized Loading -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
		<link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800&display=swap" as="style" />
		<!-- Web Vitals Monitoring (Optional - for performance tracking) -->
		<script>
			// Report Web Vitals to analytics (optional)
			// You can send these to your analytics service
			if ('web-vitals' in window) {
				const reportWebVitals = (metric) => {
					console.log(metric);
					// Send to analytics: gtag('event', metric.name, { value: metric.value });
				};
			}
		</script>
	</head>
	<body>
		<!-- Skip to Main Content Link -->
		<a href="#main-content" class="skip-link">Skip to main content</a>

		<!-- Scroll Progress Indicator -->
		<div id="scroll-progress" class="fixed top-0 left-0 h-1 bg-gradient-to-r from-[var(--accent)] via-[var(--foreground)] to-[var(--accent)] z-50 transition-all duration-300" style="width: 0%" role="progressbar" aria-label="Page scroll progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>

		<!-- Back to Top Button -->
		<button
			id="back-to-top"
			class="fixed bottom-8 right-8 w-12 h-12 bg-[var(--foreground)] text-[var(--background)] rounded-full shadow-2xl opacity-0 pointer-events-none transition-all duration-300 hover:scale-110 hover:shadow-[0_0_30px_rgba(0,0,0,0.3)] z-40 flex items-center justify-center"
			aria-label="Back to top"
		>
			<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
			</svg>
		</button>

		<main id="main-content">
			<slot />
		</main>

		<!-- Performance: Defer non-critical scripts -->
		<script>
			// Add loading="lazy" to all images without it (fallback)
			if ('loading' in HTMLImageElement.prototype) {
				document.querySelectorAll('img:not([loading])').forEach(img => {
					img.loading = 'lazy';
				});
			}

			// Preload next page on hover (for faster navigation)
			const links = document.querySelectorAll('a[href^="/"]');
			links.forEach(link => {
				link.addEventListener('mouseenter', () => {
					const url = link.getAttribute('href');
					if (url && !document.querySelector(`link[rel="prefetch"][href="${url}"]`)) {
						const prefetch = document.createElement('link');
						prefetch.rel = 'prefetch';
						prefetch.href = url;
						document.head.appendChild(prefetch);
					}
				}, { once: true });
			});

			// Scroll Progress Indicator
			const scrollProgress = document.getElementById('scroll-progress');
			const updateScrollProgress = () => {
				const windowHeight = window.innerHeight;
				const documentHeight = document.documentElement.scrollHeight;
				const scrollTop = window.scrollY;
				const scrollPercent = (scrollTop / (documentHeight - windowHeight)) * 100;
				const progress = Math.min(scrollPercent, 100);
				scrollProgress.style.width = `${progress}%`;
				scrollProgress.setAttribute('aria-valuenow', Math.round(progress).toString());
			};

			window.addEventListener('scroll', updateScrollProgress, { passive: true });
			updateScrollProgress();

			// Back to Top Button
			const backToTop = document.getElementById('back-to-top');
			const toggleBackToTop = () => {
				if (window.scrollY > 300) {
					backToTop.classList.remove('opacity-0', 'pointer-events-none');
					backToTop.classList.add('opacity-100', 'pointer-events-auto');
				} else {
					backToTop.classList.add('opacity-0', 'pointer-events-none');
					backToTop.classList.remove('opacity-100', 'pointer-events-auto');
				}
			};

			window.addEventListener('scroll', toggleBackToTop, { passive: true });

			backToTop.addEventListener('click', () => {
				window.scrollTo({ top: 0, behavior: 'smooth' });
			});
		</script>
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
